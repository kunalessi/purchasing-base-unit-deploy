/*! For license information please see bundle.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){"use strict";t=function(){return r};var n,r={},o=Object.prototype,a=o.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",d=s.toStringTag||"@@toStringTag";function l(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(n){l=function(e,t,n){return e[t]=n}}function u(e,t,r,o){var a=t&&t.prototype instanceof m?t:m,s=Object.create(a.prototype);return l(s,"_invoke",function(e,t,r){var o=1;return function(a,s){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===a)throw s;return{value:n,done:!0}}for(r.method=a,r.arg=s;;){var i=r.delegate;if(i){var c=k(i,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var d=h(e,t,r);if("normal"===d.type){if(o=r.done?4:2,d.arg===p)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(o=4,r.method="throw",r.arg=d.arg)}}}(e,r,new B(o||[])),!0),s}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=u;var p={};function m(){}function f(){}function g(){}var v={};l(v,i,(function(){return this}));var y=Object.getPrototypeOf,w=y&&y(y(S([])));w&&w!==o&&a.call(w,i)&&(v=w);var E=g.prototype=m.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(t,n){function r(o,s,i,c){var d=h(t[o],t,s);if("throw"!==d.type){var l=d.arg,u=l.value;return u&&"object"==e(u)&&a.call(u,"__await")?n.resolve(u.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):n.resolve(u).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,c)}))}c(d.arg)}var o;l(this,"_invoke",(function(e,t){function a(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(a,a):a()}),!0)}function k(e,t){var r=t.method,o=e.i[r];if(o===n)return t.delegate=null,"throw"===r&&e.i.return&&(t.method="return",t.arg=n,k(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var a=h(o,e.i,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var s=a.arg;return s?s.done?(t[e.r]=s.value,t.next=e.n,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,p):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function L(e){this.tryEntries.push(e)}function I(e){var t=e[4]||{};t.type="normal",t.arg=n,e[4]=t}function B(e){this.tryEntries=[[-1]],e.forEach(L,this),this.reset(!0)}function S(t){if(null!=t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,s=function e(){for(;++o<t.length;)if(a.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return s.next=s}}throw new TypeError(e(t)+" is not iterable")}return f.prototype=g,l(E,"constructor",g),l(g,"constructor",f),f.displayName=l(g,d,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,d,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},b(x.prototype),l(x.prototype,c,(function(){return this})),r.AsyncIterator=x,r.async=function(e,t,n,o,a){void 0===a&&(a=Promise);var s=new x(u(e,t,n,o),a);return r.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(E),l(E,d,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},r.values=S,B.prototype={constructor:B,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n){s.type="throw",s.arg=e,t.next=n}for(var o=t.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a[4],i=this.prev,c=a[1],d=a[2];if(-1===a[0])return r("end"),!1;if(!c&&!d)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=i){if(i<c)return this.method="next",this.arg=n,r(c),!0;if(i<d)return r(d),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var a=o?o[4]:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o[2],p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),I(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;I(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={i:S(e),r:t,n:r},"next"===this.method&&(this.arg=n),p}},r}function n(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var s=e.apply(t,r);function i(e){n(s,o,a,i,c,"next",e)}function c(e){n(s,o,a,i,c,"throw",e)}i(void 0)}))}}document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("login-section"),n=document.getElementById("main-content"),o=document.getElementById("logout-button"),a=document.getElementById("login-button"),s=document.getElementById("search-button"),i=document.getElementById("save-button"),c=document.getElementById("upload-button"),d=document.getElementById("theme-toggle"),l=(document.getElementById("theme-icon"),document.getElementById("sun-icon")),u=document.getElementById("moon-icon"),h=document.getElementById("home-link"),p=document.getElementById("about-link"),m=document.getElementById("about-popup"),f=document.getElementById("close-popup"),g=localStorage.getItem("token");g?(e.classList.add("hidden"),n.classList.remove("hidden"),o.classList.remove("hidden")):(e.classList.remove("hidden"),n.classList.add("hidden"),o.classList.add("hidden")),"dark"===(localStorage.getItem("theme")||"dark")?(document.body.classList.add("dark"),l.classList.add("hidden"),u.classList.remove("hidden")):(document.body.classList.remove("dark"),l.classList.remove("hidden"),u.classList.add("hidden")),d.addEventListener("click",(function(){var e=document.body.classList.toggle("dark");localStorage.setItem("theme",e?"dark":"light"),l.classList.toggle("hidden",e),u.classList.toggle("hidden",!e)})),a.addEventListener("click",r(t().mark((function r(){var a,s,i,c,d;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=document.getElementById("username").value.trim(),s=document.getElementById("password").value.trim(),a&&s){t.next=5;break}return alert("Please enter both username and password."),t.abrupt("return");case 5:return t.prev=5,console.log("Sending login request with username:",a),t.next=9,fetch("/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"username=".concat(encodeURIComponent(a),"&password=").concat(encodeURIComponent(s))});case 9:if(i=t.sent,console.log("Login response status:",i.status),i.ok){t.next=17;break}return t.next=14,i.text();case 14:throw c=t.sent,console.error("Login response error text:",c),new Error("Login failed: ".concat(c));case 17:return t.next=19,i.json();case 19:d=t.sent,console.log("Login response data:",d),localStorage.setItem("token",d.access_token),e.classList.add("hidden"),n.classList.remove("hidden"),o.classList.remove("hidden"),t.next=31;break;case 27:t.prev=27,t.t0=t.catch(5),console.error("Detailed login error:",{message:t.t0.message,name:t.t0.name,stack:t.t0.stack}),alert("Login failed: ".concat(t.t0.message,". Please ensure you are connected to the deployed application."));case 31:case"end":return t.stop()}}),r,null,[[5,27]])})))),o.addEventListener("click",(function(){localStorage.removeItem("token"),e.classList.remove("hidden"),n.classList.add("hidden"),o.classList.add("hidden"),window.scrollTo({top:0,behavior:"smooth"})})),h.addEventListener("click",(function(t){t.preventDefault(),window.scrollTo({top:0,behavior:"smooth"}),g?(e.classList.add("hidden"),n.classList.remove("hidden"),o.classList.remove("hidden")):(e.classList.remove("hidden"),n.classList.add("hidden"),o.classList.add("hidden"))}));var v=function(e){e.preventDefault(),m.classList.remove("hidden")};p.addEventListener("click",v),p.addEventListener("touchstart",v);var y=function(){m.classList.add("hidden")};function w(){return(w=r(t().mark((function r(a,s,i){var c,d,l,u,h,p,m;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,c=localStorage.getItem("token"),console.log("Token being sent for datasheet download:",c),c){t.next=5;break}throw new Error("No token found. Please log in again.");case 5:return i.textContent="Downloading...",i.disabled=!0,t.next=9,fetch("/api/datasheet/".concat(a),{method:"GET",headers:{Authorization:"Bearer ".concat(c)}});case 9:if((d=t.sent).ok){t.next=15;break}return t.next=13,d.text();case 13:throw l=t.sent,new Error("Failed to download datasheet: ".concat(l));case 15:return t.next=17,d.blob();case 17:u=t.sent,h=window.URL.createObjectURL(u),(p=document.createElement("a")).href=h,m=s?s.split(/[\\/]/).pop():"datasheet_".concat(a,".pdf"),p.download=m,document.body.appendChild(p),p.click(),p.remove(),window.URL.revokeObjectURL(h),t.next=33;break;case 29:t.prev=29,t.t0=t.catch(0),console.error("Error downloading datasheet:",t.t0),t.t0.message.includes("401")||t.t0.message.includes("No token found")?(alert("Session expired or not authenticated. Please log in again."),localStorage.removeItem("token"),e.classList.remove("hidden"),n.classList.add("hidden"),o.classList.add("hidden"),window.scrollTo({top:0,behavior:"smooth"})):alert("Error downloading datasheet: ".concat(t.t0.message));case 33:return t.prev=33,i.textContent="Download Datasheet",i.disabled=!1,t.finish(33);case 37:case"end":return t.stop()}}),r,null,[[0,29,33,37]])})))).apply(this,arguments)}f.addEventListener("click",y),f.addEventListener("touchstart",y),m.addEventListener("click",(function(e){e.target===m&&y()}));var E=1,b=[];function x(e){b=function(e){var t=document.getElementById("filter-company").value.toLowerCase().trim(),n=document.getElementById("filter-type").value.toLowerCase().trim(),r=parseFloat(document.getElementById("filter-score").value)||0;return e.filter((function(e){var o=!t||(e.company||"").toLowerCase().includes(t),a=!n||(e.product_type||"").toLowerCase().includes(n),s=!r||(e.match_score||0)>=r;return o&&a&&s}))}(e.products||e),console.log("Filtered products:",b);var t=document.getElementById("products-table").getElementsByTagName("tbody")[0];t.innerHTML="";var n=5*(E-1),r=n+5,o=b.slice(n,r);if(0===o.length&&0===b.length){var a=t.insertRow().insertCell();a.colSpan=8,a.textContent="No products found. Try adding a product or uploading a datasheet.",a.className="p-4 text-center text-gray-600 dark:text-gray-400"}else o.forEach((function(e){var n=t.insertRow();n.className="hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-200",n.insertCell().textContent=e.company||"N/A",n.insertCell().textContent=e.name||"N/A",n.insertCell().textContent=e.product_type||"N/A",n.insertCell().textContent=e.match_score?"".concat(e.match_score,"%"):"N/A",n.insertCell().textContent=e.directory||"N/A",n.insertCell().textContent=e.datasheet_path||"N/A",n.insertCell().textContent=e.specs?e.specs.substring(0,100)+(e.specs.length>100?"...":""):"N/A";var r=n.insertCell();if(e.product_id&&e.datasheet_path&&"N/A"!==e.datasheet_path){var o=document.createElement("button");o.textContent="Download Datasheet",o.className="text-coral-500 hover:underline transition-all duration-200",o.addEventListener("click",(function(){return function(e,t,n){return w.apply(this,arguments)}(e.product_id,e.datasheet_path,o)})),r.appendChild(o)}else r.textContent="N/A"}));!function(){var e=document.getElementById("pagination"),t=Math.ceil(b.length/5);e.innerHTML="";for(var n=function(t){var n=document.createElement("button");n.textContent=t,n.className="px-4 py-2 rounded-lg ".concat(t===E?"bg-coral-500 text-white border-2 border-coral-600":"bg-gray-200 text-gray-700 border-2 border-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600"," hover:bg-coral-400 hover:text-white hover:font-semibold hover:scale-105 focus:ring-2 focus:ring-coral-300 active:bg-coral-600 transition-all duration-200"),n.addEventListener("click",(function(){E=t,x(b)})),e.appendChild(n)},r=1;r<=t;r++)n(r)}()}s.addEventListener("click",r(t().mark((function r(){var a,s,i,c,d,l,u;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=document.getElementById("requirements-text").value.trim()){t.next=4;break}return alert("Please enter requirements to search."),t.abrupt("return");case 4:return s=document.getElementById("search-text"),i=document.getElementById("search-spinner"),s.textContent="Searching...",i.classList.remove("hidden"),t.prev=8,c=localStorage.getItem("token"),console.log("Sending semantic search request with token:",c),t.next=13,fetch("/api/semantic_search",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)},body:JSON.stringify({requirements:a})});case 13:if(d=t.sent,console.log("Semantic search response status:",d.status),d.ok){t.next=23;break}return t.next=18,d.text();case 18:if(l=t.sent,console.error("Semantic search response error text:",l),401!==d.status){t.next=22;break}throw new Error("Session expired or not authenticated. Please log in again.");case 22:throw new Error("Search failed: ".concat(l));case 23:return t.next=25,d.json();case 25:u=t.sent,console.log("Search response:",u),u.products&&0!==u.products.length?x(u):(console.log("No products found in response."),x({products:[]})),t.next=35;break;case 30:t.prev=30,t.t0=t.catch(8),console.error("Detailed search error:",{message:t.t0.message,name:t.t0.name,stack:t.t0.stack}),alert("Error searching products: ".concat(t.t0.message,". Please ensure you are connected to the deployed application and that products are added to the database.")),t.t0.message.includes("Session expired")&&(localStorage.removeItem("token"),e.classList.remove("hidden"),n.classList.add("hidden"),o.classList.add("hidden"),window.scrollTo({top:0,behavior:"smooth"}));case 35:return t.prev=35,s.textContent="Search",i.classList.add("hidden"),t.finish(35);case 39:case"end":return t.stop()}}),r,null,[[8,30,35,39]])})))),i.addEventListener("click",r(t().mark((function e(){var n,r,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n={company_name:document.getElementById("company-name").value.trim(),product_name:document.getElementById("product-name").value.trim(),product_type:document.getElementById("product-type").value.trim(),datasheet_path:document.getElementById("datasheet-path").value.trim()||"N/A",specs:document.getElementById("specs").value.trim()}).company_name&&n.product_name&&n.product_type&&n.specs){e.next=4;break}return alert("Please fill in all required fields (Company Name, Product Name, Product Type, Specifications)."),e.abrupt("return");case 4:return e.prev=4,e.next=7,fetch("/api/products",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(n)});case 7:if((r=e.sent).ok){e.next=13;break}return e.next=11,r.text();case 11:throw o=e.sent,new Error("Save failed: ".concat(o));case 13:return e.next=15,r.json();case 15:alert('Product "'.concat(n.product_name,'" saved successfully!')),document.getElementById("product-form").reset(),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(4),console.error("Error saving product:",e.t0),alert("Error saving product: ".concat(e.t0.message,". Please ensure you are connected to the deployed application."));case 23:case"end":return e.stop()}}),e,null,[[4,19]])})))),c.addEventListener("click",r(t().mark((function e(){var n,r,o,a,i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.getElementById("datasheet-upload"),r=n.files[0]){e.next=5;break}return alert("Please select a PDF file to upload."),e.abrupt("return");case 5:return(o=new FormData).append("file",r),e.prev=7,e.next=10,fetch("/api/upload",{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:o});case 10:if((a=e.sent).ok){e.next=16;break}return e.next=14,a.text();case 14:throw i=e.sent,new Error("Upload failed: ".concat(i));case 16:return e.next=18,a.json();case 18:alert('Datasheet "'.concat(r.name,'" uploaded and processed successfully!')),n.value="",document.getElementById("requirements-text").value&&s.click(),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(7),console.error("Error uploading datasheet:",e.t0),alert("Error uploading datasheet: ".concat(e.t0.message,". Please ensure you are connected to the deployed application."));case 27:case"end":return e.stop()}}),e,null,[[7,23]])})))),document.getElementById("filter-company").addEventListener("input",(function(){E=1,x(b)})),document.getElementById("filter-type").addEventListener("input",(function(){E=1,x(b)})),document.getElementById("filter-score").addEventListener("input",(function(){E=1,x(b)}))}))})();